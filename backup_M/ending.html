<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>무혼 비동: 전설의 시작</title>
    <style>
        @font-face {font-family: 'Dokdo'; src: url('assets/common/Dokdo-Regular.ttf') format('truetype'); font-weight: normal; font-style: normal; }
        body { 
            margin: 0; 
            background: #000; 
            overflow: hidden; 
            font-family: 'Dokdo', cursive;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* 16:9 비율 유지 래퍼 */
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 56.25vw; /* 16:9 */
            max-height: 100vh;
            max-width: 177.78vh; /* 16:9 */
            background: #000;
        }
        
        #endingWrapper { 
            width: 1600px; 
            height: 900px; 
            position: absolute; 
            left: 0; 
            top: 0; 
            transform-origin: top left;
            overflow: hidden;
            background: #000;
        }

        /* ★ [추가] 탈출 성공 오버레이: 클릭 유도용 */
        #escapeOverlay {
            position: absolute; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; cursor: pointer;
        }
        #escapeMsg { color: #fff; font-size: 120px; text-shadow: 0 0 20px #00ffcc; margin-bottom: 20px; }
        #clickHint { color: #888; font-size: 40px; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

        #endingVideo {
            position: absolute; width: 100%; height: 100%; object-fit: cover;
            z-index: 20; display: none; /* 처음엔 숨김 */
        }

        #endingBG {
            position: absolute; width: 100%; height: 100%;
            background: url('assets/ending/bg_ending.png') no-repeat center/cover;
            opacity: 0; transition: opacity 2s;
            z-index: 1;
        }

        #credits {
            position: absolute; width: 100%; text-align: center; color: white; 
            font-size: 60px; line-height: 1.8;
            text-shadow: 4px 4px 15px rgba(0, 0, 0, 1), -4px -4px 15px rgba(0, 0, 0, 1);
            top: 950px;
            z-index: 10;
            display: none;
        }

        .start-scroll {
            animation: rollUp 20s linear forwards; 
        }

        @keyframes rollUp {
            0% { top: 600px; } 
            100% { top: -2000px; } 
        }

        #restartBtn {
            position: absolute; left: 50%; top: 75%; transform: translate(-50%, -50%);
            padding: 25px 70px; background: rgba(0,0,0,0.8); color: #fff;
            border: none; cursor: pointer; font-size: 60px; font-family: 'Dokdo';
            display: none; text-shadow: 2px 2px 10px rgba(0,0,0,0.8);
            transition: 0.3s;
            z-index: 30;
        }
        #restartBtn:hover { color: #fc2828; transform: translate(-50%, -50%) scale(1.1); }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="endingWrapper">
        <div id="escapeOverlay">
            <div id="escapeMsg">"탈출이다!"</div>
            <div id="clickHint">...</div>
        </div>

        <video id="endingVideo" src="assets/ending/ending_cutscene.mp4"></video>
        
        <div id="endingBG"></div>

        <div id="credits">
            <p style="font-size: 110px; color: #ffcc00; margin-top: 200px; margin-bottom: 150px;">- 전설의 시작 -</p>
            <p>수많은 칼날과 도끼의 비를 뚫고</p>
            <p>그대는 마침내 무혼의 힘을 손에 넣었도다.</p>
            <br>
            <p style="color: #00ffcc; font-size: 70px;">[ 개발 기록 ]</p>
            <p>기획 및 총괄 : 정수</p>
            <p>기술 지원 및 조력 : 깐돌이</p>            
            <p style="font-size: 45px; color: #ffffff;">© 2026 무혼 비동 프로젝트</p>
            <p style="font-size:45px; color: #ffffff;">감사합니다.</p>
        </div>

        <button id="restartBtn" onclick="location.href='index.html'">무혼 비동으로 돌아가기</button>
        </div>
    </div>

    <script>
        // 반응형 스케일링 함수
        function scaleGame() {
            const container = document.getElementById('gameContainer');
            const wrapper = document.getElementById('endingWrapper');
            const baseWidth = 1600;
            const baseHeight = 900;
            
            const scaleX = container.offsetWidth / baseWidth;
            const scaleY = container.offsetHeight / baseHeight;
            const scale = Math.min(scaleX, scaleY);
            
            wrapper.style.transform = `scale(${scale})`;
        }
        
        // 페이지 로드 및 리사이즈 시 스케일링 적용
        window.addEventListener('load', scaleGame);
        window.addEventListener('resize', scaleGame);
        
    
        const overlay = document.getElementById('escapeOverlay');
        const video = document.getElementById('endingVideo');
        const bg = document.getElementById('endingBG');
        const credits = document.getElementById('credits');
        const restartBtn = document.getElementById('restartBtn');

        // ★ 1. 오버레이 클릭 및 터치 시 영상 재생 시작
        function startEndingVideo() {
            overlay.style.display = 'none'; // 오버레이 숨기기
            video.style.display = 'block'; // 영상 보이기
            video.play();                  // 영상 재생
        }
        
        overlay.addEventListener('click', startEndingVideo);
        overlay.addEventListener('touchstart', (e) => {
            e.preventDefault();
            startEndingVideo();
        });

        // 2. 영상 종료 시 크레딧 시작
        video.onended = () => {
            video.style.display = 'none';
            bg.style.opacity = '1';
            credits.style.display = 'block';
            credits.classList.add('start-scroll');
        };

        // 3. 크레딧 애니메이션 종료 시 버튼 등장
        credits.addEventListener('animationend', () => {
            restartBtn.style.display = 'block';
            restartBtn.animate([
                { opacity: 0, transform: 'translate(-50%, -50%) scale(0.8)' },
                { opacity: 1, transform: 'translate(-50%, -50%) scale(1)' }
            ], {
                duration: 1000,
                easing: 'ease-out',
                fill: 'forwards'
            });
        });
    </script>
</body>
</html>